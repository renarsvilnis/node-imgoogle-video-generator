{"version":3,"sources":["../es6/scraper.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;mBAEG,KAAK;;;;uBAED,SAAS;;;;uBACT,SAAS;;;;yBAEL,aAAa;;AAE9B,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAa,EAAE,EAAE;AACzC,SAAO,iBAAI,OAAO,uBAAY,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;CAC3C,CAAC;;;AAEK,IAAM,WAAW,GAAG,SAAd,WAAW,CAAa,GAAG,EAAE;AACxC,SAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM,EAAK;AACtC,8BAAQ,GAAG,EAAE;AACX,aAAO,EAAE,KAAK;KACf,EAAE,UAAU,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;AAC3B,UAAI,CAAC,GAAG,IAAI,GAAG,CAAC,UAAU,KAAK,GAAG,EAAE;AAClC,eAAO,CAAC,IAAI,CAAC,CAAC;OACf,MAAM;AACL,cAAM,CAAC,GAAG,CAAC,CAAC;OACb;KACF,CAAC,CAAC;GACJ,CAAC,CAAC;CACJ,CAAC;;;AAEK,IAAM,oBAAoB,GAAG,SAAvB,oBAAoB,CAAa,IAAI,EAAE;AAClD,SAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM,EAAK;AACtC,QAAI,CAAC,GAAG,qBAAQ,IAAI,CAAC,IAAI,CAAC,CAAC;;AAE3B,QAAI,OAAO,GAAG,CAAC,CAAC,kBAAkB,CAAC,CAAC;AACpC,QAAI,MAAM,GAAG,EAAE,CAAC;;AAEhB,WAAO,CAAC,IAAI,CAAC,YAAY;AACvB,UAAI,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AAC9B,YAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAClB,CAAC,CAAC;;AAEH,WAAO,CAAC,MAAM,CAAC,CAAC;GACjB,CAAC,CAAC;CACJ,CAAC;;;;qBAEa,UAAU,MAAM,EAAE;AAC/B,MAAM,GAAG,GAAG,aAAa,CAAC,MAAM,CAAC,CAAC;AAClC,SAAO,WAAW,CAAC,GAAG,CAAC,CACpB,IAAI,CAAC,oBAAoB,CAAC,CAAC;CAC/B","file":"scraper.js","sourcesContent":["'use strict';\n\nimport url from 'url';\n\nimport cheerio from 'cheerio';\nimport request from 'request';\n\nimport {IMAGE_URL} from './constants';\n\nexport const createPageUrl = function (id) {\n  return url.resolve(IMAGE_URL, String(id));\n};\n\nexport const getPageHtml = function (url) {\n  return new Promise((resolve, reject) => {\n    request(url, {\n      timeout: 10000\n    }, function (err, res, html) {\n      if (!err && res.statusCode === 200) {\n        resolve(html);\n      } else {\n        reject(err);\n      }\n    });\n  });\n};\n\nexport const getImageListFromHtml = function (html) {\n  return new Promise((resolve, reject) => {\n    let $ = cheerio.load(html);\n\n    let $images = $('.post .photo img');\n    let images = [];\n\n    $images.each(function () {\n      let src = $(this).attr('src');\n      images.push(src);\n    });\n\n    resolve(images);\n  });\n};\n\nexport default function (pageId) {\n  const url = createPageUrl(pageId);\n  return getPageHtml(url)\n    .then(getImageListFromHtml);\n}\n"]}